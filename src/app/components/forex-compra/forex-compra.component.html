<div class="forex-container glass-card">
  <h2 class="titulo">Pares de Divisas (Forex)</h2>

  <!-- Lista de pares -->
  <div class="lista-pares" *ngIf="!parSeleccionado">
    <div *ngFor="let par of paresDivisas" class="card" (click)="seleccionarPar(par)">
      <h3>{{ par.nombre }}</h3>
      <p>ðŸ’± Compra: {{ par.precioCompra }}</p>
      <p>ðŸ’¸ Venta: {{ par.precioVenta }}</p>
      <button (click)="verGraficaDesdeLista(par); $event.stopPropagation()">ðŸ“ˆ Ver GrÃ¡fica</button>
    </div>
  </div>

  <!-- GrÃ¡fica + Formulario -->
  <div *ngIf="parSeleccionado && !confirmacion" class="formulario">
    <h3>Invertir en {{ parSeleccionado.nombre }}</h3>

    <!-- Mostrar precios actuales -->
<div class="precios-forex">
  <span>ðŸ’± Compra (Ask): <strong style="color:#00ffcc">${{ parSeleccionado.precioCompra?.toFixed(2) }}</strong></span> |
  <span>ðŸ’¸ Venta (Bid): <strong style="color:#ffcc00">${{ parSeleccionado.precioVenta?.toFixed(2) }}</strong></span>
</div>

    <!-- GrÃ¡fica -->
    <div class="grafica-par">
      <app-chart-wrapper [tipo]="'forex'" [simbolo]="parSeleccionado.simbolo"></app-chart-wrapper>
    </div>

    <label>Monto (MXN):</label>
    <input type="number" [(ngModel)]="monto" placeholder="Ej. 1000" min="100" />

    <label>DuraciÃ³n (dÃ­as):</label>
    <select [(ngModel)]="duracion">
      <option value="7">7 dÃ­as</option>
      <option value="15">15 dÃ­as</option>
      <option value="30">30 dÃ­as</option>
      <option value="60">60 dÃ­as</option>
      <option value="90">90 dÃ­as</option>
    </select>

    <div class="acciones">
      <button (click)="confirmarInversion()">Confirmar</button>
      <button class="cancelar" (click)="cancelar()">Cancelar</button>
    </div>
  </div>

  <!-- ConfirmaciÃ³n -->
  <div *ngIf="confirmacion" class="confirmacion-cards">
    <h2>âœ… ConfirmaciÃ³n de compra</h2>
    <p>Tu inversiÃ³n se registrÃ³ exitosamente.</p>
    <ul>
      <li><strong>Par de Divisas:</strong> {{ parSeleccionado?.nombre }}</li>
      <li><strong>Monto:</strong> ${{ monto }}</li>
      <li><strong>DuraciÃ³n:</strong> {{ duracion }} dÃ­as</li>
      <li><strong>Precio de compra:</strong> {{ parSeleccionado?.precioCompra }}</li>
      <li><strong>Precio de venta:</strong> {{ parSeleccionado?.precioVenta }}</li>
      <li><strong>Forma de pago:</strong> Fondos en cuenta</li>
    </ul>
    <button class="btn-cancelar" (click)="cancelar()">Inicio</button>

    <div *ngIf="movimientos.length > 0" class="tabla-movimientos">
      <h4>ðŸ“‹ Historial de movimientos</h4>
      <table>
        <thead>
          <tr>
            <th>Tipo</th>
            <th>Monto</th>
            <th>Fecha</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let mov of movimientos">
            <td>{{ mov.type }}</td>
            <td>${{ mov.amount }}</td>
            <td>{{ mov.timestamp | date:'dd/MM/yyyy HH:mm' }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
