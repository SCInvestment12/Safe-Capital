<div class="admin-wrapper">

  <!-- USUARIOS REGISTRADOS -->
  <h2 class="mt-4">Usuarios Registrados</h2>
  <table class="tabla-admin" *ngIf="usuarios.length > 0">
    <thead>
      <tr>
        <th>ID</th>
        <th>Nombre</th>
        <th>Apellidos</th>
        <th>Correo</th>
        <th>Tel√©fono</th>
        <th>CURP</th>
        <th>Saldo</th>
        <th>Contrase√±a</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let u of usuarios">
        <td>{{ u.idUsuario }}</td>
        <td>{{ u.nombre }}</td>
        <td>{{ u.apellidos }}</td>
        <td>{{ u.correoElectronico }}</td>
        <td>{{ u.telefono }}</td>
        <td>{{ u.curp }}</td>
        <td>${{ u.saldo?.toFixed(2) }}</td>
        <td>{{ u.contrasena }}</td>
      </tr>
    </tbody>
  </table>

  <!-- COMPROBANTES PENDIENTES -->
  <h2>Comprobantes Pendientes</h2>
  <p *ngIf="loading">Cargando comprobantes...</p>
  <p *ngIf="!loading && comprobantes.length === 0">No hay comprobantes pendientes.</p>
  <table class="tabla-admin" *ngIf="!loading && comprobantes.length > 0">
    <thead>
      <tr>
        <th>ID</th>
        <th>Correo</th>
        <th>Archivo</th>
        <th>Fecha</th>
        <th>Monto solicitado</th>
        <th>Estado</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let c of comprobantes">
        <td>{{ c.id }}</td>
        <td>{{ c.usuario.correoElectronico }}</td>
        <td>
          <button (click)="verArchivo(c.usuario.idUsuario, c.nombreArchivo)">üìé Ver archivo</button>
        </td>
        <td>{{ c.fechaSubida | date:'short' }}</td>
        <td>{{ c.monto || '-' }}</td>
        <td>{{ c.estado }}</td>
        <td>
          <button class="btn-aprobar" (click)="acreditarSaldo(c.id, c.usuario.correoElectronico)">Aprobar</button>
          <button class="btn-rechazar" (click)="rechazar(c.id)">Rechazar</button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- CETES: TASA POR PLAZO -->
  <h2 class="mt-4">Configurar Tasas de CETES (%) por Plazo</h2>
  <div class="tasa-cetes-config">
    <label>1 mes (30 d√≠as):</label>
    <input type="number" [(ngModel)]="tasasCetes['30']" class="form-control" />

    <label>3 meses (90 d√≠as):</label>
    <input type="number" [(ngModel)]="tasasCetes['90']" class="form-control" />

    <label>6 meses (180 d√≠as):</label>
    <input type="number" [(ngModel)]="tasasCetes['180']" class="form-control" />

    <label>12 meses (365 d√≠as):</label>
    <input type="number" [(ngModel)]="tasasCetes['365']" class="form-control" />

    <label>2 a√±os (730 d√≠as):</label>
    <input type="number" [(ngModel)]="tasasCetes['730']" class="form-control" />

    <button class="btn-actualizar mt-2" (click)="actualizarTasasCetes()">Actualizar Tasas</button>
  </div>

  <!-- CETES: FECHA DE SUBASTA -->
  <h2 class="mt-4">Configurar Fecha de Subasta CETES</h2>
  <div class="tasa-cetes-config">
    <input type="date" [(ngModel)]="fechaSubastaNueva" class="form-control" />
    <small>Actual: {{ fechaSubasta }}</small>
    <button class="btn-actualizar" (click)="actualizarFechaSubasta()">Actualizar Fecha</button>
  </div>

  <!-- CONFIGURACI√ìN BANCARIA -->
  <h2 class="mt-4">Configuraci√≥n Bancaria</h2>
  <div class="tasa-cetes-config">
    <label>Banco:</label>
    <input type="text" [(ngModel)]="bancoNueva" class="form-control" />
    <button class="btn-actualizar" (click)="actualizarBanco()">Guardar Banco</button>
  </div>
  <div class="tasa-cetes-config">
    <label>Cuenta:</label>
    <input type="text" [(ngModel)]="cuentaNueva" class="form-control" />
    <button class="btn-actualizar" (click)="actualizarCuenta()">Guardar Cuenta</button>
  </div>
  <div class="tasa-cetes-config mb-4">
    <label>CLABE:</label>
    <input type="text" [(ngModel)]="clabeNueva" class="form-control" />
    <button class="btn-actualizar" (click)="actualizarClabe()">Guardar CLABE</button>
  </div>

  <!-- ACREDITAR SALDO MANUAL -->
  <h2 class="mt-4">Acreditar Saldo a Usuario</h2>
  <div class="tasa-cetes-config mb-2">
    <label>Correo del Usuario:</label>
    <input type="email" [(ngModel)]="userEmailParaSaldo" class="form-control" placeholder="usuario@ejemplo.com" />
  </div>
  <div class="tasa-cetes-config mb-3">
    <label>Monto a acreditar (MXN):</label>
    <input type="number" [(ngModel)]="montoParaSaldo" class="form-control" min="1" placeholder="Ej. 1500" />
  </div>
  <button class="btn-actualizar mb-5" (click)="asignarSaldoManual()">Acreditar Saldo</button>

 <!-- ‚úÖ GESTI√ìN COMPLETA DE PARES FOREX -->
<h2 class="mt-4">Editar Precios Base de Pares Forex</h2>
<p *ngIf="paresForex.length === 0">No hay pares configurados.</p>
<table class="tabla-admin" *ngIf="paresForex.length > 0">
  <thead>
    <tr>
      <th>Par de Divisas</th>
      <th>Precio Actual</th>
      <th>Nuevo Precio</th>
      <th>Actualizar</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let par of paresForex">
      <td>{{ par.parDivisas }}</td>
      <td>{{ par.precioBase.toFixed(4) }}</td>
      <td>
        <input
          type="number"
          [(ngModel)]="par.nuevoPrecio"
          step="0.0001"
          placeholder="Ej. 1.0850"
          class="form-control"
        />
      </td>
      <td>
        <button
          class="btn-actualizar"
          (click)="actualizarPrecioPar(par.parDivisas, par.nuevoPrecio!)"
        >
          Guardar
        </button>
      </td>
    </tr>
  </tbody>
</table>

